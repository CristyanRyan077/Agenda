<Window x:Class="AgendaNovo.MainWindow"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        SizeToContent="Manual"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:vm="clr-namespace:AgendaNovo"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:hc="https://handyorg.github.io/handycontrol"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        x:Name="main"
        MinWidth="800" MinHeight="600"
        d:DataContext="{d:DesignInstance Type=vm:AgendaViewModel}"
        Title="MainWindow">
    <Window.Resources>
        <DropShadowEffect x:Key="DropShadow"
                      BlurRadius="5"
                      ShadowDepth="2"
                      Opacity="0.3" />
    </Window.Resources>
    <DockPanel>
    <ToolBarTray DockPanel.Dock="Top">
        <ToolBar Height="73"  Background="White">
            <Button x:Name="btnAgenda" Padding="4" Click="btnAgenda_Click"
                        Height="60" BorderBrush="Black" BorderThickness="1" FontSize="14">
                <StackPanel>
                        <materialDesign:PackIcon Height="32" Width="55" Kind="BookAdd"/>
                        <TextBlock FontWeight="Bold" Foreground="Blue">Agendar</TextBlock>
                </StackPanel>
            </Button>
            <Button x:Name="btnClientes" Padding="4" Click="btnClientes_Click"
                        Height="60" Margin="10,0,0,0" BorderBrush="Black" FontSize="14">
                <StackPanel>
                        <materialDesign:PackIcon Kind="UserAdd" Height="32" Width="55"/>
                        <TextBlock FontWeight="Bold" Foreground="Red">Clientes</TextBlock>
                </StackPanel>
            </Button>
        </ToolBar>
    </ToolBarTray>

    <TabControl Margin="0,4,0,0">
        <TabItem Header="Semanal">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid>
                        <Grid.Background>
                            <ImageBrush ImageSource="/Imagens/download.jpeg"/>
                        </Grid.Background>

                        <Grid HorizontalAlignment="Center" Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <FrameworkElement x:Name="SegProxy" Tag="{Binding DiaChkSeg}" Visibility="Collapsed"/>
                            <FrameworkElement x:Name="TerProxy" Tag="{Binding DiaChkTer}" Visibility="Collapsed"/>
                            <FrameworkElement x:Name="QuaProxy" Tag="{Binding DiaChkQua}" Visibility="Collapsed"/>
                            <FrameworkElement x:Name="QuiProxy" Tag="{Binding DiaChkQui}" Visibility="Collapsed"/>
                            <FrameworkElement x:Name="SexProxy" Tag="{Binding DiaChkSex}" Visibility="Collapsed"/>
                            <FrameworkElement x:Name="SabProxy" Tag="{Binding DiaChkSab}" Visibility="Collapsed"/>
                            <FrameworkElement x:Name="DomProxy" Tag="{Binding DiaChkDom}" Visibility="Collapsed"/>
                            <Grid Margin="0,8" Background="#55FFFFFF" Grid.Column="1" Effect="{StaticResource DropShadow}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Button Content="← Semana Anterior"
                            Command="{Binding SemanaAnteriorCommand}"
                            FontWeight="Bold"
                                        Grid.Column="0"
                            FontSize="12"
                            Background="#FFDDDD"
                            BorderBrush="Black"
                            Margin="0,0"
                            Padding="2,4"/>

                            <TextBlock Text="{Binding SemanaExibida, StringFormat='Semana {0}'}"
                               VerticalAlignment="Center"
                               FontSize="16" Grid.Column="1"
                               FontWeight="Bold"
                               Margin="10,0"
                               Foreground="Black"
                               FontFamily="Segoe UI Black"/>

                                                <Button Content="Próxima Semana →"
                            Command="{Binding ProximaSemanaCommand}"
                            FontWeight="Bold"
                            FontSize="14" Grid.Column="2"
                            Background="#DDFFDD"
                            BorderBrush="Black"
                            Margin="0,0"
                            Padding="8,4"/>
                            </Grid>
                            <!-- SEGUNDA -->
                            <Grid Grid.Row="1" Grid.Column="0">
                                <TextBlock Text="Segunda"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Foreground="Black"
                                               HorizontalAlignment="Center"
                                               Width="152" Height="32"
                                               Background="#FF13FF00"
                                               TextAlignment="Center"
                                               FontFamily="Segoe UI Black" VerticalAlignment="Top"
                                                />

                                <Border HorizontalAlignment="Stretch" MinWidth="430" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=SegProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <hc:Card Background="#88FFFFFF" HorizontalAlignment="Stretch" Opacity="1.0">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Height="380">
                                            <ItemsControl ItemsSource="{Binding AgendamentosSegunda}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Vertical"/>
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>

                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420"
                                                                Margin="6"
                                                                Padding="8"
                                                                CornerRadius="8"
                                                                Background="White"
                                                                BorderBrush="#DDD"
                                                                BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"
                                                                Effect="{StaticResource DropShadow}">
                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>
                                                                <Grid Margin="0 0 4 5">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*" />
                                                                        <ColumnDefinition Width="auto" />
                                                                    </Grid.ColumnDefinitions>


                                                                    <StackPanel Orientation="Horizontal" Grid.Column="0" Margin="0 0 4 5">
                                                                        <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                        <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                        <TextBlock Text=" | " Foreground="Gray"/>
                                                                        <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                        <TextBlock Text=" | " Foreground="Gray"/>
                                                                        <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                    </StackPanel>
                                                                    <Button Grid.Column="1"
                                                                            Width="34" 
                                                                            Background="#E6F6EA"
                                                                            BorderBrush="#A8D5A2"
                                                                            BorderThickness="1"
                                                                            Command="{Binding DataContext.ConcluirAgendamentoCommand,
                                                                                      RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            CommandParameter="{Binding}">
                                                                        <TextBlock Text="✓" FontSize="18" Foreground="Green"
                                                                                    HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                    </Button>
                                                                </Grid>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>
                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>

                            <!-- TERÇA -->
                            <Grid Grid.Row="1" Grid.Column="1">
                                <TextBlock Text="Terça" FontSize="20" FontWeight="Bold" Foreground="Black"
                                           HorizontalAlignment="Center" Width="154" Background="#FF13FF00"
                                           TextAlignment="Center" Height="32" FontFamily="Segoe UI Black" VerticalAlignment="Top"/>
                                <Border HorizontalAlignment="Stretch" MinWidth="430" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=TerProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <hc:Card Background="#88FFFFFF" >
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" Height="380">
                                            <ItemsControl ItemsSource="{Binding AgendamentosTerca}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>

                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420"
                                                                Margin="6"
                                                                Padding="8"
                                                                CornerRadius="8"
                                                                Background="White"
                                                                BorderBrush="#DDD"
                                                                BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"
                                                                Effect="{StaticResource DropShadow}">
                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal" Margin="0 0 4 5">
                                                                    <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                    <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>
                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>




                            <!-- Sexta -->
                            <Grid Grid.Row="2" Grid.Column="1">
                                <TextBlock Text="Sexta" FontSize="20" Height="32" FontWeight="Bold" Foreground="Black"
                                           HorizontalAlignment="Center" Width="154" Background="#FF13FF00"
                                           TextAlignment="Center" FontFamily="Segoe UI Black" VerticalAlignment="Top"/>
                                <Border HorizontalAlignment="Stretch" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=SexProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <hc:Card Background="#88FFFFFF">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" Height="380">
                                            <ItemsControl ItemsSource="{Binding AgendamentosSexta}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420" Margin="6" Padding="8" CornerRadius="8"
                                                                Background="White" BorderBrush="#DDD" BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"
                                                                Effect="{StaticResource DropShadow}">

                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal" Margin="0 0 4 5">
                                                                    <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                    <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>
                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>

                            <!-- QUINTA -->
                            <Grid Grid.Row="2" Grid.Column="0">
                                <TextBlock Text="Quinta" FontSize="20" FontWeight="Bold" Foreground="Black"
                                           HorizontalAlignment="Center" Width="154" Height="32"  Background="#FF13FF00"
                                           TextAlignment="Center" VerticalAlignment="Top" FontFamily="Segoe UI Black"/>
                                <Border HorizontalAlignment="Stretch" MinWidth="430" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=QuiProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <hc:Card Background="#88FFFFFF" >
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" Height="380">
                                            <ItemsControl ItemsSource="{Binding AgendamentosQuinta}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420" Margin="6" Padding="8" CornerRadius="8"
                                                                Background="White" BorderBrush="#DDD" BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"                                                               
                                                                Effect="{StaticResource DropShadow}">
                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal" Margin="0 0 4 5">
                                                                    <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                    <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>

                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="14" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="14" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>

                            <!-- QUARTA -->
                            <Grid Grid.Row="1" Grid.Column="2">
                                <TextBlock Text="Quarta" FontSize="20" Height="32" FontWeight="Bold" Foreground="Black"
                                               HorizontalAlignment="Center" Width="154" Background="#FF13FF00"
                                               TextAlignment="Center" FontFamily="Segoe UI Black" VerticalAlignment="Top"/>
                                <Border HorizontalAlignment="Stretch" MinWidth="430" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=QuaProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <hc:Card Background="#88FFFFFF">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" Height="380">
                                            <ItemsControl ItemsSource="{Binding AgendamentosQuarta}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Vertical" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420" Margin="6" Padding="8" CornerRadius="8"
                                                                Background="White" BorderBrush="#DDD" BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"                                                               
                                                                Effect="{StaticResource DropShadow}">
                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 4 5">
                                                                    <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                    <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>
                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>

                            <!-- SÁBADO -->
                            <Grid Grid.Row="2" Grid.Column="2">
                                <TextBlock Text="Sábado"
                                           FontSize="20"
                                           FontWeight="Bold"
                                           Foreground="Black"
                                           HorizontalAlignment="Center"
                                           Width="154" Height="32"
                                           Background="#FF13FF00"
                                           TextAlignment="Center"
                                           FontFamily="Segoe UI Black" VerticalAlignment="Top"
                                            />

                                <Border HorizontalAlignment="Stretch" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=SabProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <hc:Card Background="#88FFFFFF" Opacity="1.0">
                                        <ScrollViewer HorizontalScrollBarVisibility="Auto" Height="380" VerticalScrollBarVisibility="Auto">
                                            <ItemsControl ItemsSource="{Binding AgendamentosSabado}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Orientation="Vertical" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>

                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420"
                                                                Margin="6"
                                                                Padding="8"
                                                                CornerRadius="8"
                                                                Background="White"
                                                                BorderBrush="#DDD"
                                                                BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"
                                                                Effect="{StaticResource DropShadow}">
                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal" Margin="0 0 4 5">
                                                                    <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                    <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>
                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>


                            <!-- DOMINGO -->
                            <Grid Grid.Row="3" Grid.Column="1">
                                <TextBlock Text="Domingo"
                                           FontSize="20"
                                           FontWeight="Bold"
                                           Foreground="Black"
                                           HorizontalAlignment="Center"
                                           Width="154" Height="32"
                                           Background="#FF13FF00"
                                           TextAlignment="Center"
                                           FontFamily="Segoe UI Black" VerticalAlignment="Top"
                                            />

                                <Border MinWidth="430" Margin="5,30,4,14">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Tag, ElementName=DomProxy}" Value="True">
                                                    <Setter Property="BorderBrush" Value="Red"/>
                                                    <Setter Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <hc:Card Background="#88FFFFFF" Opacity="1.0">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" Height="380">
                                            <ItemsControl ItemsSource="{Binding AgendamentosDomingo}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>

                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="420"
                                                                Margin="6"
                                                                Padding="8"
                                                                CornerRadius="8"
                                                                Background="White"
                                                                BorderBrush="#DDD"
                                                                BorderThickness="1"
                                                                MouseLeftButtonDown="Border_MouseLeftButtonDown"
                                                                Effect="{StaticResource DropShadow}">
                                                            <StackPanel>
                                                                <StackPanel Orientation="Horizontal" Margin="0 0 0 0">
                                                                    <TextBlock Text="{Binding Cliente.Nome}" FontFamily="Segoe UI" FontWeight="Bold" FontSize="16"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Telefone}" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray" Margin="4,0"/>
                                                                    <TextBlock Text="{Binding Cliente.Email}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal" Margin="0 0 4 5">
                                                                    <TextBlock Text="↳ " FontSize="16" Margin="5,-6,0,0"/>
                                                                    <TextBlock Text="{Binding Crianca.Nome}" FontFamily="Arial" FontSize="14"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.IdadeFormatada}" FontSize="12"/>
                                                                    <TextBlock Text=" | " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Crianca.Genero}" FontSize="12"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Servico.Nome}" FontWeight="Bold" FontSize="13" Margin="0 0 10 4" FontFamily="Helvetica"/>
                                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 5 0" FontFamily="Helvetica">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="Red"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                    <TextBlock Text=" / " Foreground="Gray"/>
                                                                    <TextBlock Text="{Binding Valor, StringFormat=R$ {0:N2}}" FontWeight="Bold" FontSize="13" Margin="0 0 0 4" FontFamily="Helvetica"/>
                                                                </StackPanel>

                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Text="{Binding Tema}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Data, StringFormat=dd/MM/yyyy}" FontSize="12" Margin="0 0 6 0"/>
                                                                    <TextBlock Text="{Binding Horario, StringFormat={}{0:hh\\:mm}}" FontSize="12"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </hc:Card>
                                </Border>
                            </Grid>

                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Mensal">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="850" />
                        </Grid.ColumnDefinitions>
                        <Grid.Background>
                        <ImageBrush ImageSource="/Imagens/baixados.jpeg"/>
                        </Grid.Background>

                        <!-- Coluna Esquerda: Calendário -->
                        <hc:Card Grid.Column="0" Padding="10" Margin="0,0,20,0" Background="Transparent">
                            <Calendar SelectedDate="{Binding DataSelecionada, Mode=TwoWay}"
                          Language="pt-br"
                          Cursor="Hand"
                          HorizontalAlignment="Center"
                          Height="328" Width="300">
                                <Calendar.LayoutTransform>
                                    <ScaleTransform ScaleX="1.5" ScaleY="1.5" />
                                </Calendar.LayoutTransform>
                            </Calendar>
                        </hc:Card>

                        <!-- Coluna Direita: Filtros, Botões, DataGrid -->
                        <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Top">

                            <!-- Linha de pesquisa -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <hc:TextBox Text="{Binding TextoPesquisa, UpdateSourceTrigger=PropertyChanged}"
                                 Width="250" Height="60"
                                FontSize="24" FontFamily="Arial" 
                                hc:InfoElement.Placeholder="Pesquisar" />
                                <materialDesign:PackIcon Kind="Search" Height="50" Width="50"
                                 Margin="-45,0,0,0" VerticalAlignment="Center" />
                                <hc:TextBox Text="{Binding NovoAgendamento.ValorPago, UpdateSourceTrigger=PropertyChanged }"
                                Width="250" Height="60" Margin="10,0,0,0"
                                hc:InfoElement.Placeholder="Pago"
                                Background="White" Foreground="Black" FontFamily="Helvetica" FontSize="24" FontWeight="Bold"
                                BorderBrush="Transparent" SelectionTextBrush="Black" />
                                
                            </StackPanel>

                            <!-- Linha de botões -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0,0,10">
                                <Button Content="✓" Width="90" Height="60"
                            FontWeight="Bold" FontSize="24"
                            Background="Green" Foreground="White"
                            Command="{Binding AgendarCommand}" />

                                <Button Content="❌" Width="80" Height="60" Margin="10,0"
                            FontWeight="Bold" FontSize="24"
                            Background="Red" Foreground="White"
                            Command="{Binding ExcluirCommand}" />
                                <Button Content="Mostrar Todos" Background="Blue"
                                        Width="120" Height="60" Margin="5,0,0,0"
                                        Foreground="White" FontSize="14" FontWeight="Bold"
                                        Command="{Binding MostrarTodosCommand}" />
                                <Button Content="Copiar horários livres"
                                     Command="{Binding CopiarHorariosLivresCommand}"
                                     FontSize="15" FontFamily="Arial" 
                                     Width="170" Height="50"
                                     Margin="10" Background="#FF00FFE2"   />
                                 <materialDesign:PackIcon Kind="Clock" Width="50" Height="40"
                                 Foreground="White"
                                 VerticalAlignment="Center"/>
                            </StackPanel>

                            <!-- DataGrid -->

                                <DataGrid Height="300" Width="830" Grid.Column="1"
                              VerticalScrollBarVisibility="Auto" HorizontalAlignment="Left"
                              ScrollViewer.CanContentScroll="True"
                              ItemsSource="{Binding AgendamentosFiltrados, Mode=TwoWay}"
                              SelectedItem="{Binding ItemSelecionado, Mode=TwoWay}"
                              AutoGenerateColumns="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Id" Binding="{Binding Id}" />
                                        <DataGridTextColumn Header="Cliente" Binding="{Binding Cliente.Nome}" />
                                        <DataGridTextColumn Header="Crianca" Binding="{Binding Crianca.Nome}" />
                                        <DataGridTextColumn Header="Genero" Binding="{Binding Crianca.Genero}" />
                                        <DataGridTextColumn Header="Idade" Binding="{Binding Crianca.Idade}" />
                                        <DataGridTextColumn Header="Telefone" Binding="{Binding Cliente.Telefone}" />
                                    <DataGridTextColumn Header="Servico.Nome" Width="70" Binding="{Binding Servico.Nome}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                                <Setter Property="TextWrapping" Value="NoWrap"/>
                                                <Setter Property="ToolTip" Value="{Binding Servico.Nome}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                        <DataGridTextColumn Header="Tema" Binding="{Binding Tema}" />
                                        <DataGridTextColumn Header="Valor" Binding="{Binding Valor, StringFormat=R$ {0:N2}}" />
                                        <DataGridTemplateColumn Header="Pago">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding ValorPago, StringFormat=R$ {0:N2}}"
                                                   FontWeight="Bold" FontSize="13" FontFamily="Helvetica">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Foreground" Value="Red" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding EstaPago}" Value="True">
                                                                        <Setter Property="Foreground" Value="Green" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="Horário" Binding="{Binding Horario, StringFormat=\{0:hh\\:mm\}}" />
                                        <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=dd/MM/yyyy}" />
                                    </DataGrid.Columns>
                                </DataGrid>


                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
    


            <TextBlock TextWrapping="Wrap" Text="TextBlock"/>
    </TabControl>
</DockPanel>
 </Window>

